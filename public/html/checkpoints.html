<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkpoint Basics</title>
  <link rel="stylesheet" href="../styles/styles.css">
</head>
<body>
  <div class="navbar">
    <div class="logo">Smash Hit Modding</div>
    <div class="nav-links">
      <a href="index.html">Home</a>
      <a href="#">Tutorial</a>
    </div>
  </div>
  <div class="content">
    <h1 style="margin-bottom: 10px;">Checkpoint Basics</h1>
    <p>Learn how to make checkpoints for Smash Hit using Shatter OSS, Blender, and an XML level file.</p>
    <h2>Creating a Custom Checkpoint</h2>
    <p>Creating a custom checkpoint involves creating custom segments. Here are the steps to create a custom checkpoint:</p>
    <ol>
      <li>Make sure to have Shatter OSS and Blender.</li>
      <li>Start designing your checkpoint using tools.</li>
      <li>Once design is complete, export the model in a compatible format.</li>
      <li>Make sure to save it in a Smash Hit APK file.</li>
    </ol>
    <h2>Scripting a Checkpoint</h2>
    <p>To script a checkpoint, you will need to write code that defines the behavior of the checkpoint, including fog colors and echo effects. Here is a simple example of how to script a checkpoint:</p>
    <pre>function init() -- Runs once at the start when the room is loaded
    -- Your initialization code here
end<br>
function tick() -- Runs every frame approximately 60 times per second
end</pre>
    <h3>Example Script</h3>
    <p>Here is an example of a checkpoint script:</p>
    <pre>function init()
    pStart = mgGetBool("pStart", false) -- Retrieves a boolean parameter named "pStart"
    pEnd = mgGetBool("pEnd", false) -- Retrieves a boolean parameter named "pEnd"

    mgReverb(0.3, 0.8, 0.2) -- Sets the reverb effect parameters
    mgEcho(0.7, 0.8, 0.9, 1.0) -- Sets the echo effect parameters
    mgLowPass(math.random()) -- Sets a random low-pass filter value

    mgFogColor(1.6, 1.4, 2, -.8, 0, 0) -- Sets the fog color parameters
    mgGravity(1.0) -- Sets the gravity for the room

    mgMusic("1") -- Sets the music
    mgSetRotation(1) -- Sets the rotation for the room
    
    -- Segment configuration
    confSegment("basic/darker/bs", 1)
    confSegment("basic/darker/2_bs_arch", 1)
    confSegment("basic/darker/chasms", 1)
    confSegment("basic/darker/chasms_bs", 1)
    confSegment("basic/darker/powerup", 1, 1)

    l = 0

    if pStart then
        l = l + mgSegment("basic/darker/start", -l) -- Adds a starting segment if pStart is true
    end

    local targetLen = 300

    while l &lt; targetLen do 
        s = nextSegment() -- Gets the next segment
        l = l + mgSegment(s, -l) -- Adds the segment to the room
    end

    if pEnd then
        l = l + mgSegment("basic/darker/door", -l) -- Adds an ending segment if pEnd is true
    end

    mgLength(l) -- Sets the total length of the room
end

function tick()
end</pre>
    <h2>Level File</h2>
    <p>The level file is where you find checkpoints in order using the XML structure. Here is an example of how checkpoints are defined in a level file:</p>
    <pre>&lt;level&gt;
    &lt;room type="night/part1" length="250" start="true" end="true"/&gt;
    &lt;room type="night/part2" length="250" start="true" end="false"/&gt;
    &lt;room type="night/part2" length="250" start="false" end="true"/&gt;
    &lt;room type="night/part3" length="250" start="true" end="true"/&gt;
    &lt;room type="night/boss" length="100"/&gt;<br>&lt;/level&gt;</pre>
    <ul>
      <li>Each <code>&lt;room&gt;</code> tag defines a checkpoint with attributes for <code>type</code>, <code>length</code>, <code>start</code>, and <code>end</code>.</li>
      <li>The <code>type</code> attribute specifies the segment type.</li>
      <li>The <code>length</code> attribute specifies the length of the segment. It defines how long the room is.</li>
      <li>The <code>start</code> and <code>end</code> attributes indicate if the segment is a starting or ending checkpoint. If <code>false</code>, then the room will repeat again more longer.</li>
    </ul>
    <button class="btn" id="readBtn">Read text</button>
  </div>
  <script>
    const readBtn = document.getElementById('readBtn');
    const content = document.querySelector('.content');
    readBtn.addEventListener('click', function() {
      readBtn.disabled = true;
      const textToRead = Array.from(content.querySelectorAll('p, li')).map(p => p.innerText).join(' ');
      const utterance = new SpeechSynthesisUtterance(textToRead);
      speechSynthesis.speak(utterance);
      utterance.pitch = 1;
      utterance.rate = 1;
      utterance.volume = 1;
      utterance.onend = function() {
        readBtn.disabled = false;
      };
    });
  </script>
</body>
</html>